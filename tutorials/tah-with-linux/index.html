<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->

  <title>Tah Library</title>

  <!-- css -->
  <link href='http://fonts.googleapis.com/css?family=Quattrocento' rel='stylesheet' type='text/css'>  
  <link rel="stylesheet" href="/css/application.min.css"> 
  <link rel="stylesheet" href="/css/menubar.css">
  <link rel="stylesheet" href="/css/blogpagecss.css">
  
  <!-- js -->
  <script src="/js/application.min.js"></script>
  <!-- Mobile Specific Metas
  ================================================== -->

</head>
<body>
  <header>
    <div class="topbar">
      <div class="topbar-innerdiv">
        <div class="col-lg-5 col-md-5 col-sm-7 col-xs-7">
          <ul class="topbar-socialicons">
            <li><a href="https://www.facebook.com/pages/Tah/633568926721880" target="_blank"><i class="fa fa-facebook"></i></a></li>
            <li><a href="https://twitter.com/tah_io" target="_blank"><i class="fa fa-twitter"></i></a></li>
            <li><a href="https://instagram.com/tah-io" target="_blank"><i class="fa fa-instagram"></i></a></li>
            <li><a href="https://plus.google.com/+TahIoble/posts" target="_blank"><i class="fa fa-google-plus"></i></a></li>
            <li><a href="https://www.youtube.com/channel/UCY7RNCi0S8jQDE3BZQw5Gwg" target="_blank"><i class="fa fa-youtube"></i></a></li>
            <li><a href="https://github.com/tah-io" target="_blank"><i class="fa fa-github"></i></a></li>
          </ul>
        </div>

        <!-- <div class="col-sm-3 col-md-3 col-sm-5 col-sm-5 pull-right searchbox">
          <form id="frmSearch" class="search2" method="get" />
          <input id="keywords" size="24" placeholder="Search...">
        </div> -->
      </div>
    </div>
    <div class="logo_div">
      <div class="logo_inner_div">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <div class="col-xs-6 col-sm-7 col-md-4  col-lg-4 ">
            <img src="/img/header-tah-logo-for-doc-page.png" class="header-logo"/><span class="header-text">Tah Docs</span>
          </div>
          <div class="col-xs-4 col-sm-5 col-md-8 col-lg-8">
            <a href="https://www.crowdsupply.com/revealing-hour/tah-open-ble-arduino-board" target="_blank">
              <img src="/img/buy-now.png" class="cta-buy-now"/>
            </a>
          </div>
          <div id="smallNav" class="col-xs-2 col-sm-0 col-md-0 col-lg-0">
            <div id="nav-trigger">
              <span class="">&#8801;</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="menu_div_one">
      <div class="menu_innerdiv_one">
        <ul class="menu_list_one">
          <li><a href="/index.html">Home</a></li>
          <li><a href="http://tah.io/start">Getting Started</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="/library">Library</a></li>
          <li><a href="/showcase">Showcase</a></li>
          <li><a href="/contributing">Contributing</a></li>
          <li><a href="/apps">Apps</a></li>
          <li><a href="http://blog.tah.io">Blog</a></li>
          <li><a href="http://discuss.tah.io">Forum</a></li>
        </ul>
      </div>
    </div>
  
    <nav id="nav-mobile">
      <ul class="" style="display: none;">
        <li><a href="/index.html">Home</a></li>
        <li><a href="http://tah.io/start">Getting Started</a></li>
        <li><a href="/tutorials">Tutorials</a></li>
        <li><a href="/library">Library</a></li>
        <li><a href="/showcase">Showcase</a></li>
        <li><a href="/contributing">Contributing</a></li>
        <li><a href="/apps">Apps</a></li>
        <li><a href="http://blog.tah.io">Blog</a></li>
        <li><a href="http://discuss.tah.io">Forum</a></li>
      </ul>
    </nav>
  </header>

  <div class="container containerdocs">
    <div class="text-docs">
      <h1 class="page_heading">Tah with Linux</h1>

      <p>Tah is a Bluetooth Low Energy open source development platform compatible with the Arduino. In this tutorial we are going to take a look at how to control Tah from a Linux machine.</p>

      <h2 class="docshead2">Requirements</h2>

      <ul>
        <li>Tah</li>
        <li><a href="http://www.adafruit.com/products/1327">CSR 4.0 dongle</a></li>
        <li>Linux machine (Raspberry Pi, BeagleBone Black, Laptop, PC)</li>
      </ul>

      <h2 class="docshead2">Step 1</h2>

      <p><a href="https://lwn.net/Articles/531133/">BlueZ</a> provides the official support for Bluetooth in Linux. We will be using
      <a href="http://www.bluez.org/">version 5.0</a> or above, since that added the support for BLE. We need a kernel above 3.5 for this to work.</p>

      <p class="example_code">
        <pre>
uname -a
Linux beaglebone 3.8.13-bone41 #1 SMP Tue Mar 4 22:51:47 UTC 2014 armv7l GNU/Linux</pre>
      </p>

      Make sure that the USB module is connected and has been detected</p>

      <p class="example_code">
<pre>lsusb
  Bus 001 Device 002: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)
  Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
  Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</pre>
      </p>
        
      <p>Next install bluez</p>

      <p class="example_code">
        <pre>apt-get install bluez</pre>
      </p>

      Verify that it has been installed with hciconfig.
      Next scan for Bluetooth devices</p>

      <p class="example_code">
<pre>hcitool scan
  Scanning ...
  B8:E8:56:35:38:DF Anuj’s MacBook Pro</pre>
      </p>

      <p>This will return all Bluetooth 3.0 devices. This doesn't include any Bluetooth 4.0 (BLE)devices</p>
    
      <h2 class="docshead2">Step 2</h2>

      <p>Now scan for Bluetooth 4.0 devices</p>
      
      <div class="example_code">
<pre>hcitool lescan
  LE Scan ...
  7C:66:9D:9B:2D:DA (unknown)
  7C:66:9D:9B:2D:DA DHIRAJ
  7C:66:9D:9B:2D:DA (unknown)
  7C:66:9D:9B:2D:DA DHIRAJ
  7C:66:9D:9B:2D:DA (unknown)</pre>
      </div>
    
      <h2 class="docshead2">Step 3</h2>

      Now, to connect to a BLE device using <a href="https://developer.bluetooth.org/gatt/Pages/GATT-Specification-Documents.aspx">GATT</a> profiles

      <p class="example_code">
        <pre>sudo gatttool -b xx:xx:xx:xx:xx:xx -I</pre>
      </p>

      <p>You will see an interactive prompt. Type connect like below</p>

      <p class="example_code">
        <pre>[xx:xx:xx:xx:xx:xx][LE]> connect</pre>
      </p>

      <p>On Successful connection with Tah, the onboard blue led will stop blinking and stay lit.</p>
            
      <h2 class="docshead2">Step 4</h2>

      <p>To communicate with Tah, we need the characterstics handle for TX and RX.</p>

      <p>In the case of Tah BLE module the characterstics handle address is <strong>0x0012</strong> for both RX and TX.</p>

      <h4>Transmit</h4>

      <p>Here we are going to control the onboard LED of Tah when their is data received by Tah from the characterstic handle <strong>0x0012</strong>. To see the data is received by Tah.</p>

      <p>Upload <a href="https://github.com/tah-io/Tah_Arduino_Library/tree/master/examples/TahWithLinux">Tah_Arduino sketch</a> to Tah which will display it on the serial monitor and simultaneously <strong>pin13</strong> led will blink for 1 sec and goes low.</p>

      <p>Now type below to turn the LED ON</p>

      <p class="example_code">
        <pre> [xx:xx:xx:xx:xx:xx][LE]>char-write-cmd 0x0012 010100</pre>
      </p>

      <h4>Receive</h4>

      <p> The 0x0012 is the handle of the Client Characteristic Configuration (CCC) uuid ffe1. You can find this 0x0012 handle by typing char-read-uuid ffe1 in the gatttool interactive prompt.</p>

      <p class="example_code">
<pre>[xx:xx:xx:xx:xx:xx][LE]>char-write-cmd 0x0012 A00100
[xx:xx:xx:xx:xx:xx][LE]>char-write-req 0x0012 0100 –listen</pre>
      </p>

      <p>Similarly when the data is transfer from Tah BLE using arduino serial monitor the notification will be received at address RX handle 0x0012. you will see incoming RX value on RX handle (0x0012).</p>

    </div>
  </div>

  <footer>
    <div class="bottombar">
      <div class="bottombar-innerdiv">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 footnote">
          &copy; Revealing Hour Creations. All rights reserved.<br/>
          The text of the Tah reference is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>.<br/>Code samples in the reference are released into the public domain.
        </div>
      </div>
    </div>
  </footer>

  <div id="totopscroller"></div>
  <script>
    $(function(){
      $('#totopscroller').totopscroller({link:'http://www.jqueryscript.net'});
    })
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-36872186-2', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>
  <!-- search box -->
  <!-- <script type="text/javascript"> var myHilitor; document.addEventListener("DOMContentLoaded", function()
   { myHilitor = new Hilitor2("playground"); myHilitor.setMatchType("left"); }, false); 
    document.getElementById("keywords").addEventListener("keyup", function() { myHilitor.apply(this.value); }, false);
  </script> -->
</body>
</html>
